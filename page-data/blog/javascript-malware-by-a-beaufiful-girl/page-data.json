{
    "componentChunkName": "component---src-templates-blog-post-index-tsx",
    "path": "/blog/javascript-malware-by-a-beaufiful-girl/",
    "result": {"data":{"markdownRemark":{"id":"7ef84d86-d1bd-5119-9005-02f73b3472b7","excerpt":"I remember with almost excitement how our story began, it all started with an email, loaded with... malware? 😒 The email that started it all. I don't know any…","html":"<article class=\"prose lg:prose-lg xl:prose-lg\">\n<p>I remember with almost excitement how our story began, it all started with an email, loaded with... malware? 😒</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABBElEQVQoz3WNy07DMBBFvWOLxC71Y2w3JSSBJnbSKI3CjhVChQ1/wg/xoxeNS6u0gsXRnUnG54oYHtF1ESEwATFG9H2PpmnS3LYtqqpClmVQSkFrneDZWos8z+G9T/AuXj6/URQFhmHANE0YxzHNzDzPKbuuSwXGmLN0Kef3ZVnCOQcRnr/QxYhpvz+Kdrv0c9nMh5zXIp4ZLkplWkHc3d7g8P6B17cDnrYN6m1IjdYSpJQX8IOl7FrMCK0MVtojow1WxiPzNaQyUJIPLo+XLEUnMSPIGRApkFUwnCRBVoOchvkjT1yLzsK8tvAFgdPdE3xpsa6O+7qkNPuH3ywofeP9P+EP+3nH4x4iQEQAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"phishing email\" title=\"phishing email\" src=\"/static/c9a4a33be1e4d192f8994d36450c7da5/e5715/email.png\" srcset=\"/static/c9a4a33be1e4d192f8994d36450c7da5/8514f/email.png 192w,\n/static/c9a4a33be1e4d192f8994d36450c7da5/804b2/email.png 384w,\n/static/c9a4a33be1e4d192f8994d36450c7da5/e5715/email.png 768w,\n/static/c9a4a33be1e4d192f8994d36450c7da5/4ad3a/email.png 1152w,\n/static/c9a4a33be1e4d192f8994d36450c7da5/71c1d/email.png 1536w,\n/static/c9a4a33be1e4d192f8994d36450c7da5/df438/email.png 1556w\" sizes=\"(max-width: 768px) 100vw, 768px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<p>The email that started it all. I don't know any Juliette Leblanc, who, by the way, advises us to avoid printing the email. We wouldn't want to burden this planet with useless paper... and deprive ourselves of a satisfying click on that precious attachment.</p>\n<p>Already anticipating the content of the file that Juliette wants me to open with the browser, I decide to take a different path and open it with VScode editor.</p>\n<p>The file appears like this, after \"beautifying\" it appropriately, as it was originally minified.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 70.3125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACEUlEQVQ4y32T/W6jMBDE8yyXDwjGxjbGBhNI20RRG6nv/zi/k02aS9rq/hjtsqBhd2d2VSlD93pEhxHVRZQ70ISZxo2oNlJpj2gH6nbIUdgERyEbNvv6B1abSmL6Hh9PSBORuqNSDUXdUCZIw67W36DYCpkJtpW8Y7OXrLZCsa8U0R+5nD44TzOv44lDCBwHR+87pLYYYxBKs60UO9HcyX50uBOKdSWppeZtnnj/uOKHmXiYGYNj8I6uC4imZS8NZW0opHnq7pE8E5a1xjYWbUa874mhJXQt1hi01uwqyfpbJ4+jPhKvdmlPQjH5A9N0pfcnOudRjWJfSzalYL0XD2TiVzHuIxdSZ3YhNabtsf2M9iN7HZDtiOleaNqINAGRFDc9dcqNR+hArXsqZSkTpFlGToR/SkFrHHF8wYSRtvUEH+jDgLGe4ra7QlqKWmcX/DpyKXVWLX3kXCDOJ0x/RPuYPfdPUfUDqZkFzR23kRWFslgfcXHGDgeki4jG5T9/TbEQyf9ilczYWM/8eqUZzujwRhjeaccLKqT9TQgT2EnDNnWRjW3yc85TTGuQNtezsaXpOEwX5vmTcLwShgtuPKP7I910RvqJygSkG5czTNH2S6075DzFVF99LddoT/QjbRcX5RrL9rafpGC2l7oJksS5nWEpl3eLYDeVE2lda4Ry+X7XZfXsr1I8x0cvPtUEfwEfRrCnUeJrxAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"deobfuscated code\" title=\"deobfuscated code\" src=\"/static/b8b6e6f45e648bba19ac2825303edef0/e5715/deobfuscated-phase-1.png\" srcset=\"/static/b8b6e6f45e648bba19ac2825303edef0/8514f/deobfuscated-phase-1.png 192w,\n/static/b8b6e6f45e648bba19ac2825303edef0/804b2/deobfuscated-phase-1.png 384w,\n/static/b8b6e6f45e648bba19ac2825303edef0/e5715/deobfuscated-phase-1.png 768w,\n/static/b8b6e6f45e648bba19ac2825303edef0/ae77d/deobfuscated-phase-1.png 1111w\" sizes=\"(max-width: 768px) 100vw, 768px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<p>The content of the suspicious attachment. At first glance, it doesn't inspire the utmost trust; it's heavily obfuscated, as if Juliette doesn't want us to understand the semantics of this piece of code.</p>\n<p>In this initial phase, let's not waste time deobfuscating it and instead move towards a dynamic analysis on an isolated browser, here's the result.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 64.0625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABi0lEQVQ4y5XT646aQBiA4b3/C+h9NOkN9E9/dUVOM+gwHBSs664CVZGD8Daga7pNmtVJvvDvYSDf+2QaEyxjgj01cMwpwpwiLRPPNvEci7ljo1wbXzho6RBIl1C6RJ4g9gSLmWA5lyRKkiqPp4+gcQOlNUXaJrMBdS+oFg6BcK6gew94vaFtMhcCJQVKOONo6RJ4gtATRJ4csU9B15xiG88so4jDfkuevVEeS9qmoa4q6uo0PqtTSaIVkXTuACc/WSUpx3LLdrtmvz9QNw19z+30fU8a+PeCz/xKlmR5ge9rlFLjtG17w7quexzc7XZEYcAijknTlDzPyYuCrCho2pZVoB8Dj+WJ9eaN4veBuq7pzmf++mgS/cANV8sFHXCozlTt5ed1fc8PnfHN2rDKSl5iTSgeAP89A/vV3PDl+4Lw9cjrIhh38lPQNQ3mrkPkK0JfEWlFrH2WgU+WRhzWMS9xcN1F975SLmOMtQwJzoZFHzO0mNsWenihfKSUsWXrQ3b+ey1DdlL8t+U/TIulVuaek+YAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"malware rendering office 365\" title=\"malware rendering office 365\" src=\"/static/30e5f511700fdcb520d87d243a5598a6/e5715/malware-rendering.png\" srcset=\"/static/30e5f511700fdcb520d87d243a5598a6/8514f/malware-rendering.png 192w,\n/static/30e5f511700fdcb520d87d243a5598a6/804b2/malware-rendering.png 384w,\n/static/30e5f511700fdcb520d87d243a5598a6/e5715/malware-rendering.png 768w,\n/static/30e5f511700fdcb520d87d243a5598a6/b6529/malware-rendering.png 1049w\" sizes=\"(max-width: 768px) 100vw, 768px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<p>Okay, we're starting to understand the intentions of our (former) friend Juliette. If my experience doesn't deceive me, once you press \"Sign in,\" our precious password won't end up directly on Microsoft's servers.</p>\n<p>Let's try.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 11.979166666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAhklEQVQI102MQQqCUBQAPYThLxFUWqSmX/Pp101GVBQdQCKEJO9/hYkiosUwsxqrPRqKbEPbtEhZUVcGKYVaakQMcaLRqSbXxcdRvCbwlvhugFILHGf+w3U9rPx6I9uPVJcJOT+JuwHf9IRNT3YYyU8TyW4g2t5ZdQ/CtGNm2zjf2Xuq/voFobY9w8JsU/kAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"malware stealing my password\" title=\"malware stealing my password\" src=\"/static/d92d4d6b85e38d971244a65d44800f46/e5715/steal-request.png\" srcset=\"/static/d92d4d6b85e38d971244a65d44800f46/8514f/steal-request.png 192w,\n/static/d92d4d6b85e38d971244a65d44800f46/804b2/steal-request.png 384w,\n/static/d92d4d6b85e38d971244a65d44800f46/e5715/steal-request.png 768w,\n/static/d92d4d6b85e38d971244a65d44800f46/4ad3a/steal-request.png 1152w,\n/static/d92d4d6b85e38d971244a65d44800f46/536c7/steal-request.png 1480w\" sizes=\"(max-width: 768px) 100vw, 768px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<p>As shown in the previous image, our username and password are forwarded to the \"purepsychedelic\" endpoint... let's leave out the explicit contents of the mentioned website.</p>\n<p>But those jokers are not satisfied with collecting non-functional passwords. The malicious backend also handles the verification of the entered password's validity, trying them on the target Outlook account.</p>\n<p>The following is the response after incorrect password.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 11.458333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAfklEQVQI11XD6wqCMACAUd/CnLaUiMptXnZLJKKwDOv9n+cL+hF04CSnKdDqnhgHbO+IPuJtILiAs57DvkYrQ2NajGrQqqGUW8qiosglQhS/UlYk/vmgizPx8safF9ph5mivKHejG1+YYcGE6VuHO7vakaWCtdiQrXLSNPv7AUY0PFeedvYRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"malware trying the credentials on outlook\" title=\"malware trying the credentials on outlook\" src=\"/static/09f4e86456326764af012de62beea21d/e5715/response-steal.png\" srcset=\"/static/09f4e86456326764af012de62beea21d/8514f/response-steal.png 192w,\n/static/09f4e86456326764af012de62beea21d/804b2/response-steal.png 384w,\n/static/09f4e86456326764af012de62beea21d/e5715/response-steal.png 768w,\n/static/09f4e86456326764af012de62beea21d/4ad3a/response-steal.png 1152w,\n/static/09f4e86456326764af012de62beea21d/1f038/response-steal.png 1481w\" sizes=\"(max-width: 768px) 100vw, 768px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<p>Let's see how the execution of this stealer occurs.</p>\n<p>Let's take the slightly deobfuscated original file and analyze it more carefully. Let's focus on the juicier parts, as this kind of code is usually quite redundant to confuse reverse engineering.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 73.4375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACHklEQVQ4y5WT2W7bMBBF/StFIlsSxU3cJMqbbMcpiv7/75xCSwwbSIH24WJIQryamcPZKB+JlxGbjiif0fGISkd02M/72iYan2n8sETXI1yg1Ib3qqGo5UvcFI3C54xPZ7TLWNviXEAZhzEWYRxFY9it2s5SbIX6i2EtKWvN0J/4ff/k4zhy3n/yc7xyP0Ryijgfcc4jTTublrJ9MXkxnP5UCIlRlmE4MF4/8CkTup7oHV1w2NZRTpkJtUo/TJ61ZCgUjWpJNuH8mdx1HDtPH1qstQilH1k86zm7lwzfa0UtFKfhQsp32vZILS3bevpQ8GNX81aJ9aJY9WXSUFRyjl9nm0rZuQRpPK47kg43Qj5jwp7Qj3TDnZBGtB9QLiP9RH9a9zRtj7IDjQnU2lNpz2bXaIqVWA49/XDGpgHvEzF1hJBm4rsn0g/iQq9ae1urBcpkVkpD6gb60w0TB6TvKU3krWx4K8W3ffxOC+VaUUqH9R069GgXETZRSfvPRg/DiY51HSlfUf6EjheMG+aJMf1tjktbltYU67MpVm2fNO0375WkTXv8cMXEM67/JHY3ZDjg8jgDKJWj1P5J4bGuTKAy8aHlHTaGIY3sD79I+UYb9rh0RrVxJjfNcKXdPMe1jYg2UU9G2iNcN5su591U8kRHEmwkphPGZYS07BrL0l+5lFMv5b7EaUIe6+V8s5MGGSO7ZqL9dVm+POD/gfIHgI/PZszNXO4AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"malware deobfuscated\" title=\"malware deobfuscated\" src=\"/static/dba778d7c313baf95282146bd6d99287/e5715/malware-deobfuscated.png\" srcset=\"/static/dba778d7c313baf95282146bd6d99287/8514f/malware-deobfuscated.png 192w,\n/static/dba778d7c313baf95282146bd6d99287/804b2/malware-deobfuscated.png 384w,\n/static/dba778d7c313baf95282146bd6d99287/e5715/malware-deobfuscated.png 768w,\n/static/dba778d7c313baf95282146bd6d99287/f680b/malware-deobfuscated.png 1108w\" sizes=\"(max-width: 768px) 100vw, 768px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<p>In the second line, the Base64-encoded \"value\" is our email. Between lines 32 and 34, the URL is generated from which a second script is downloaded to be embedded in the main page, a modus operandi similar to that of Droppers.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 746px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 11.458333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAeklEQVQI1yXGWw6CMBQAUVbSStWSiATbW+SlUPkRDXH/uxkDfJzMJOZoka4m/l4Mc8+wRPplop3HTfMeaT+R7hu5Tw/8s0aGZje2m2tw5K4k9yWJTk+YoiCrhHMQbCVYcVh3IxOPXQWP9Q5zyVEqReuV2arWPxh0uvsDgcU+tBIIVpkAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"malware running\" title=\"malware running\" src=\"/static/a42f6e0c1f5aaa6f8f70f2cbb4628505/62de4/deobfuscated-running.png\" srcset=\"/static/a42f6e0c1f5aaa6f8f70f2cbb4628505/8514f/deobfuscated-running.png 192w,\n/static/a42f6e0c1f5aaa6f8f70f2cbb4628505/804b2/deobfuscated-running.png 384w,\n/static/a42f6e0c1f5aaa6f8f70f2cbb4628505/62de4/deobfuscated-running.png 746w\" sizes=\"(max-width: 746px) 100vw, 746px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<p>The downloaded script is the following, which will be embedded in the initial web page. We're at the second stage.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 63.020833333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAByUlEQVQ4y4WS2W7bMBBF/R9FYonLkNRKbbblJU6AoEVf+v9/cwrRaeIkTvpwMaDAOTia4ao8/0H2v8k3P3HdzGa7Zxg6mjrQNg1OAk78fyPW0cWe1XT+RRjmFCk7+s2B3a7jsInsYkMsPNFbWi9UYlMabymX6iyVs9ROqKzmYT+zenx85Hg4cNzPlHVk3u95fpg47gb6usKL4I1BK8N9pm5mnWl+3GUM44bV6fxEKAqcc0go8aGi7bcUTUQZyzrXL02KLNdf5u4+Y5o2rMQFlDIopbGuxNhAWUVCWWG0Td/z10b1LXBcgPfrPCmvsxwtBSG0dNsjuzHSVoHgBK10unMN+Gh8MdyyeruQJ0PxLXGY6fuOovDkyiRg/gK5gNRNw2Gc3gONqxBfE+NAV5V0wVE6oVgs9QVstXk1XF/NdqnGygdDX6GMYxpGTlOkbxuKUBDEEkKgEMGKwxqLtYKxHmX8G9B8AtZkytL3W86nA09jzdxWjKWjLz1BJC1wsc2XMajF1nwPXOeG2E0cjzuassBog9E6bXupNp3NzV/Wxn4GLjMMzuPFItamZjEGZ0xazFdv8gZQpfnlyl62mKkEuM47wFKvwP+AfwGeM3k+L1eSzQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"second stage of the malware\" title=\"second stage of the malware\" src=\"/static/19fe770924421af5e6bb41fde0657c52/e5715/second-stage.png\" srcset=\"/static/19fe770924421af5e6bb41fde0657c52/8514f/second-stage.png 192w,\n/static/19fe770924421af5e6bb41fde0657c52/804b2/second-stage.png 384w,\n/static/19fe770924421af5e6bb41fde0657c52/e5715/second-stage.png 768w,\n/static/19fe770924421af5e6bb41fde0657c52/4ad3a/second-stage.png 1152w,\n/static/19fe770924421af5e6bb41fde0657c52/71c1d/second-stage.png 1536w,\n/static/19fe770924421af5e6bb41fde0657c52/1e5d2/second-stage.png 1630w\" sizes=\"(max-width: 768px) 100vw, 768px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<p>Subsequently, another request is made to the URL we see in line 34 of the previous image. This additional payload will also be embedded in the initial page. This is the third stage.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 20.833333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAnElEQVQY05WOSw6CMABEexJpC7TQP2giWAyKsDG6c+X97zFGiOxMdPEy8zaTIU3s4bd7lLaCUA7aBoRqB+dryELBump1bRy08TA2zLn0xd/4UIN09yfC9IA83iC7K5hQoJSDshSM56Asm/vi2VcSmkJpA3IeRvSnATF2aJoWPM2RUP43m4ShKBTIZZzQHiKEEJBSroOfV78yD5YKL9sqdfE///JPAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"malware deobfuscated\" title=\"malware deobfuscated\" src=\"/static/3e9ec802dcedd9ae85bd943700f12268/e5715/third-stage.png\" srcset=\"/static/3e9ec802dcedd9ae85bd943700f12268/8514f/third-stage.png 192w,\n/static/3e9ec802dcedd9ae85bd943700f12268/804b2/third-stage.png 384w,\n/static/3e9ec802dcedd9ae85bd943700f12268/e5715/third-stage.png 768w,\n/static/3e9ec802dcedd9ae85bd943700f12268/4ad3a/third-stage.png 1152w,\n/static/3e9ec802dcedd9ae85bd943700f12268/71c1d/third-stage.png 1536w,\n/static/3e9ec802dcedd9ae85bd943700f12268/c4842/third-stage.png 1634w\" sizes=\"(max-width: 768px) 100vw, 768px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<p>The response is Base64 encoded; the decoded payload is as follows. I highlight the most interesting part. The <code class=\"language-text\">.nextb</code> class is associated with the login button, and it has a click handler whose behavior is summarized below.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 54.166666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKUlEQVQoz51S2W7DIBDMv+QyYDAGjAkhxrkbKf3/z5nKkFTOi+X2YVlpj9mdHRasNtiwClQYtPGBrv9GiF+gtcWWVSn3F1sMz5pyrEkJ53u4eIexBxRM5Hjy4uU5VqSctMW2lLmBlJB6B+XPUPYE3oS0JZUNiGySL4TKQybsBZgnK+2w626w4QouW2yowLJgWBGGVfJ5i3f9NCDlILxG7K84Xp7ouhOY1Cm3edOeABoBvm5IRdpCmj388Qkf75DGg1YKRNTYCv0PQFKi0h42PtD6C2wbfuNz6H5Qfjdy7aH8CcZFcGUz0KhhxoZyFCgha4tmf4RqAvigsFAgXKIYiTeTci4ehNGuh2wPqLRLN2QDIKvmUv4URZgAHW4wrgevm/RtljPvNwD+AC+5ToDCLXiNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"malware deobfuscated\" title=\"malware deobfuscated\" src=\"/static/c426ba4c46782491a8db1c338a2aea00/e5715/code-send-to-server.png\" srcset=\"/static/c426ba4c46782491a8db1c338a2aea00/8514f/code-send-to-server.png 192w,\n/static/c426ba4c46782491a8db1c338a2aea00/804b2/code-send-to-server.png 384w,\n/static/c426ba4c46782491a8db1c338a2aea00/e5715/code-send-to-server.png 768w,\n/static/c426ba4c46782491a8db1c338a2aea00/4ad3a/code-send-to-server.png 1152w,\n/static/c426ba4c46782491a8db1c338a2aea00/b30aa/code-send-to-server.png 1405w\" sizes=\"(max-width: 768px) 100vw, 768px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<p>In line 1834, we notice the HTTP POST call to the malicious server. The <code class=\"language-text\">compi</code> variable will contain our email and password. The <code class=\"language-text\">ur</code> variable defined earlier will contain the attacker's server address. Juliette is indeed receiving our Outlook credentials 🤦🏻.</p>\n<p>I haven't tested the flow after entering a correct password, but the code seems to include functionality to obtain the two-factor authentication code.</p>\n<p>Our story with Juliette ends here, after dismantling her stalking objective towards me, and hopefully succeeding in imparting a bit of healthy <strong>\"security paranoia\"</strong> for when you receive an email with suspicious attachments or links in your inbox.</p>\n<p>Keep Learning<br>\nUntil next time 😎</p>\n</article>","frontmatter":{"title":"A Beautiful girl sent me this...","description":"It all started with an email 🥰","date":"Aug 08, 2023","tags":["javascript","malware","cybersecurity","phishing"],"cover":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/273eeba8905b9c948dddd0d481f34892/3b307/cover.jpg","srcSet":"/static/273eeba8905b9c948dddd0d481f34892/d9f52/cover.jpg 200w,\n/static/273eeba8905b9c948dddd0d481f34892/0132d/cover.jpg 400w,\n/static/273eeba8905b9c948dddd0d481f34892/3b307/cover.jpg 800w,\n/static/273eeba8905b9c948dddd0d481f34892/1e618/cover.jpg 1600w","sizes":"(min-width: 800px) 800px, 100vw"},"sources":[{"srcSet":"/static/273eeba8905b9c948dddd0d481f34892/b9488/cover.webp 200w,\n/static/273eeba8905b9c948dddd0d481f34892/47294/cover.webp 400w,\n/static/273eeba8905b9c948dddd0d481f34892/89c0d/cover.webp 800w,\n/static/273eeba8905b9c948dddd0d481f34892/94e9c/cover.webp 1600w","type":"image/webp","sizes":"(min-width: 800px) 800px, 100vw"}]},"width":800,"height":533}}}},"fields":{"slug":"/blog/javascript-malware-by-a-beaufiful-girl/"}}},"pageContext":{"slug":"/blog/javascript-malware-by-a-beaufiful-girl/","previous":{"fields":{"slug":"/blog/how-to-write-secure-code/"},"frontmatter":{"title":"How to write secure code"}},"next":null}},
    "staticQueryHashes": ["279501559","3159585216","3649515864"]}